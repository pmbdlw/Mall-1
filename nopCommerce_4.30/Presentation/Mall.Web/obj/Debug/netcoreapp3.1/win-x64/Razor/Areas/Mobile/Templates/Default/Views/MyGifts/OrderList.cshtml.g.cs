#pragma checksum "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\MyGifts\OrderList.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "f59dd2a47c8539d058b08447f3f839d728a50bf2"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Areas_Mobile_Templates_Default_Views_MyGifts_OrderList), @"mvc.1.0.view", @"/Areas/Mobile/Templates/Default/Views/MyGifts/OrderList.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
#nullable restore
#line 10 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using Microsoft.AspNetCore.Mvc.ViewFeatures;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using Microsoft.AspNetCore.Html;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using Microsoft.AspNetCore.Mvc.Rendering;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using Microsoft.AspNetCore.Http.Extensions;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using Microsoft.AspNetCore.Mvc;

#line default
#line hidden
#nullable disable
#nullable restore
#line 15 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using Microsoft.AspNetCore.Mvc.Razor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 16 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using Microsoft.AspNetCore.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 18 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using System.Net;

#line default
#line hidden
#nullable disable
#nullable restore
#line 19 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using System.IO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 20 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using System.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 22 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using Mall.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 23 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using Mall.Web.Framework;

#line default
#line hidden
#nullable disable
#nullable restore
#line 24 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using Mall.Web.Framework.Infrastructure;

#line default
#line hidden
#nullable disable
#nullable restore
#line 25 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using Mall.DTO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 26 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using Mall.Service;

#line default
#line hidden
#nullable disable
#nullable restore
#line 27 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using Mall.Core;

#line default
#line hidden
#nullable disable
#nullable restore
#line 28 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using Mall.Entities;

#line default
#line hidden
#nullable disable
#nullable restore
#line 30 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\_ViewImports.cshtml"
using Mall.CommonModel;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"f59dd2a47c8539d058b08447f3f839d728a50bf2", @"/Areas/Mobile/Templates/Default/Views/MyGifts/OrderList.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"251375f151a8ed74fad18b07a59f5490bcea9ba2", @"/Areas/Mobile/Templates/Default/Views/_ViewImports.cshtml")]
    public class Areas_Mobile_Templates_Default_Views_MyGifts_OrderList : Mall.Web.Framework.MobileWebViewPage<dynamic>
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
#nullable restore
#line 1 "C:\S\nopCommerce_4.30_dev\Presentation\Mall.Web\Areas\Mobile\Templates\Default\Views\MyGifts\OrderList.cshtml"
  
    ViewBag.Title = "礼品订单";
    ViewBag.ShowAside = 3;//显示浮动菜单栏、回到顶部按钮
    int? status = ViewBag.status;

#line default
#line hidden
#nullable disable
            WriteLiteral(@"<div class=""container pb0"">
	<ul class=""gift-order-nav border-bot"">
		<li data-status=""0"">全部</li>
		<li data-status=""2"">待发货<i id=""sendNum"" style=""display: none;"">0</i></li>
		<li data-status=""3"">待收货<i id=""receivedNum"" style=""display: none;"">0</i></li>
		<li data-status=""5"">已完成</li>
	</ul>
	<ul class=""gift-order-list"" id=""List""></ul>
	<div class=""loading"" id=""autoLoad""><span></span></div>
</div>

<script>
	
	
	
	$(window).scroll(function () {
        var scrollTop = $(this).scrollTop();
        var scrollHeight = $(document).height();
        var windowHeight = $(this).height();

        if (scrollTop + windowHeight >= scrollHeight) {
            loadGifts();
        }
    });
    
    var page = 0,
		isnodata = false,
		list = $('#List'),
		status=QueryString('status')||0;
	
	$('li[data-status='+status+']').addClass('active');
	
	loadGifts();
	
	$('.gift-order-nav').on('click','li',function(){
		var _this=$(this);
		status=_this.data('status');
		_this.addClass('active').s");
            WriteLiteral(@"iblings().removeClass();
		page = 0;
		isnodata = false;
		$('#autoLoad').html('<span></span>');
		list.html('');
		loadGifts();
	});
	
	$.get('/' + areaName + '/MyGifts/GetOrderCount',function(data){
		if(data.WaitDeliveryCount){
			$('#sendNum').text(data.WaitDeliveryCount).show();
		}
		if(data.WaitReceivingCount){
			$('#receivedNum').text(data.WaitReceivingCount).show();
		}
	});
	
	function loadGifts() {
	    if (!isnodata) {
	        page++;
	        $.get('/' + areaName + '/MyGifts/GetOrderList',
	            {
	                page: page,
	                pageSize: 10,
	                status:status
	            }
	            , function (data) {
	            	data=data.data.rows;
	                if (data.length > 0) {
	                    var str = '';
	                    $.each(data, function (i, item) {
	                    	str+='<li>'+
								'<div class=""gift-order-hd"">'+
									'<i class=""glyphicon glyphicon-list-alt""></i>'+item.Id+
									'<span class=");
            WriteLiteral(@"""'+(item.OrderStatus==2||item.OrderStatus==3?'active':'')+'"">'+item.ShowOrderStatus+'</span>'+
								'</div>'+
								'<div class=""gift-item"">'+
                                '<a href=""/' + areaName+'/MyGifts/OrderDetail/'+item.Id+'"">'+
										'<img src=""'+item.Items[0].DefaultImage+'"" />'+
										'<p>'+item.Items[0].GiftName+'</p>'+
										'<span>'+item.Items[0].SaleIntegral+'<em>积分</em><br/>× '+item.Items[0].Quantity+'</span>'+
									'</a>'+
								'</div>'+
								'<div class=""gift-order-txt"">共 <span>'+item.Items[0].Quantity+'</span> 件礼品  花费积分：<span>'+item.TotalIntegral+'</span></div>';
								if(item.OrderStatus==3){
                                    str += '<div class=""gift-order-bot border-top"">' +
                                        '<a class=""gift-btn light"" onclick=""ConfirmOrder(\'' + item.Id+'\',this)"">确认收货</a>'+
									'</div>';
								}
								
							str+='</li>';
	                    });
	                    list.append(str);
	                }
	");
            WriteLiteral(@"                if(data.length<10){
	                	isnodata = true;
	                    $('#autoLoad').html('没有更多订单了');
	                }
	            }
	        );
	    }
    }


    function ConfirmOrder(orderId, dom) {
        $.dialog.confirm(""你确定收到货了吗？"", function () { Confirm(orderId, dom); });
    }

    function Confirm(orderId, dom) {
        var loading = showLoading();
        $.ajax({
            type: 'post',
            url: ""/""+areaName+""/MyGifts/ConfirmOrderOver"",
            dataType: 'json',
            data: { OrderId: orderId },
            success: function (d) {
                loading.close();
                if (d.success) {
                    $.dialog.succeedTips(""确认成功！"", function () {
                        page = 0;
                        isnodata = false;
                        $('#autoLoad').html('<span></span>');
                        list.html('');
                        loadGifts();
                    }, 1);
                }
        ");
            WriteLiteral("        else {\r\n                    $.dialog.errorTips(\"确认失败！\", \'\', 2);\r\n                }\r\n            }\r\n        });\r\n    }\r\r\n</script>\r\n");
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<dynamic> Html { get; private set; }
    }
}
#pragma warning restore 1591
